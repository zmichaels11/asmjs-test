apply plugin: 'base'

subprojects {
	apply from: rootProject.file('common.gradle')
}

task buildTestsAsmjsGLES30 {
	dependsOn ':tests:calculator:calculatorAsmjsGLES30Executable'
}

task buildTestsAsmjs {
	dependsOn ':buildTestsAsmjsGLES30'
}

task buildTestsBinaryenGLES30 {
	dependsOn ':tests:calculator:calculatorBinaryenGLES30Executable'
}

task buildTestsBinaryen {
	dependsOn ':buildTestsBinaryenGLES30'
}

task buildTestsHTML {
	dependsOn ':buildTestsAsmjs'
	dependsOn ':buildTestsBinaryen'
}

task buildTestsWindows32GLES30 {
	dependsOn ':tests:calculator:calculatorWindows32GLES30Executable'
}

task buildTestsWindows64GLES30 {
	dependsOn ':tests:calculator:calculatorWindows64GLES30Executable'
}

task buildTestsWindows32GL {
	dependsOn ':tests:calculator:calculatorWindows32GLExecutable'
}

task buildTestsWindows64GL {
	dependsOn ':tests:calculator:calculatorWindows64GLExecutable'
}

task buildTestsWindows32 {
	dependsOn ':buildTestsWindows32GLES30'
	dependsOn ':buildTestsWIndows32GL'
}

task buildTestsWindows64 {
	dependsOn ':buildTestsWindows64GLES30'
	dependsOn ':buildTestsWindows64GL'
}

task buildTestsWindows {
	dependsOn ':buildTestsWindows32'
	dependsOn ':buildTestsWindows64'
}

task buildTestsLinux32GLES30 {
	dependsOn ':tests:calculator:calculatorLinux32GLES30Executable'
}

task buildTestsLinux64GLES30 {
	dependsOn ':tests:calculator:calculatorLinux64GLES30Executable'
}

task buildTestsLinux32GL {
	dependsOn ':tests:calculator:calculatorLinux32GLExecutable'
}

task buildTestsLinux64GL {
	dependsOn ':tests:calculator:calculatorLinux64GLExecutable'
}

task buildTestsLinux32 {
	dependsOn ':buildTestsLinux32GLES30'
	dependsOn ':buildTestsLinux32GL'
}

task buildTestsLinux64 {
	dependsOn ':buildTestsLinux64GLES30'
	dependsOn ':buildTestsLinux64GL'
}

task buildTestsLinux {
	dependsOn ':buildTestsLinux32'
	dependsOn ':buildTestsLinux64'
}

task buildTests {
	dependsOn ':buildTestsHTML'
	dependsOn ':buildTestsLinux'
	dependsOn ':buildTestsWindows'
}

task installWindows64Libs(type: Copy) {
	from 'share/bin/windows64/glfw3/glfw3.dll'
	from 'share/bin/windows64/angle/libGLESv2.dll'
	from 'share/bin/windows64/angle/libEGL.dll'
	from 'share/bin/windows64/openal-soft/OpenAL32.dll'

	into '/tmp/win64_tests'
}

task installWindows64Data(type: Copy) {
	from 'data'
	into '/tmp/win64_tests/data'
}

task installLinux64Data(type: Copy) {
	from 'data'
	into '/tmp/linux64_tests/data'
}

task installLinux64GL(type: Copy) {
	dependsOn ':buildTestsLinux64GL'
	dependsOn ':installLinux64Data'

	from 'tests/calculator/build/exe/calculator/linux64/gL/calculator'
	into '/tmp/linux64_tests'	
}

task installWindows64GL(type: Copy) {
	dependsOn ':buildTestsWindows64GL'
	dependsOn ':installWindows64Libs'
	dependsOn ':installWindows64Data'

	from 'tests/calculator/build/exe/calculator/windows64/gL/calculator.exe'
	into '/tmp/win64_tests'
}